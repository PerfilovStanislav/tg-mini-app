import{u as K,t as ve,r as me,c as pe,a as S,o as ee,n as ae,g as he,b as ge,i as we,d as ce,e as Q,f as M,w as H,q as ne,h as _e,T as ye,j as be,$ as Se,k as B,l as F,m as xe,p as X,s as Te,v as Y,F as Oe,x as ke,y as b,z as G,A as $}from"./index-29f99f32.js";function te(e){return he()?(ge(e),!0):!1}function _(e){return typeof e=="function"?e():K(e)}const ue=typeof window<"u"&&typeof document<"u";typeof WorkerGlobalScope<"u"&&globalThis instanceof WorkerGlobalScope;const De=e=>e!=null,Pe=Object.prototype.toString,Ee=e=>Pe.call(e)==="[object Object]",P=()=>{},re=Ce();function Ce(){var e,t;return ue&&((e=window==null?void 0:window.navigator)==null?void 0:e.userAgent)&&(/iP(?:ad|hone|od)/.test(window.navigator.userAgent)||((t=window==null?void 0:window.navigator)==null?void 0:t.maxTouchPoints)>2&&/iPad|Macintosh/.test(window==null?void 0:window.navigator.userAgent))}function fe(e,t){function o(...n){return new Promise((r,i)=>{Promise.resolve(e(()=>t.apply(this,n),{fn:t,thisArg:this,args:n})).then(r).catch(i)})}return o}function Le(e,t={}){let o,n,r=P;const i=l=>{clearTimeout(l),r(),r=P};return l=>{const c=_(e),s=_(t.maxWait);return o&&i(o),c<=0||s!==void 0&&s<=0?(n&&(i(n),n=null),Promise.resolve(l())):new Promise((d,u)=>{r=t.rejectOnCancel?u:d,s&&!n&&(n=setTimeout(()=>{o&&i(o),n=null,d(l())},s)),o=setTimeout(()=>{n&&i(n),n=null,d(l())},c)})}}function Ae(...e){let t=0,o,n=!0,r=P,i,a,l,c,s;!we(e[0])&&typeof e[0]=="object"?{delay:a,trailing:l=!0,leading:c=!0,rejectOnCancel:s=!1}=e[0]:[a,l=!0,c=!0,s=!1]=e;const d=()=>{o&&(clearTimeout(o),o=void 0,r(),r=P)};return p=>{const m=_(a),h=Date.now()-t,w=()=>i=p();return d(),m<=0?(t=Date.now(),w()):(h>m&&(c||!n)?(t=Date.now(),w()):l&&(i=new Promise((y,g)=>{r=s?g:y,o=setTimeout(()=>{t=Date.now(),n=!0,y(w()),d()},Math.max(0,m-h))})),!c&&!o&&(o=setTimeout(()=>n=!0,m)),n=!1,i)}}const Me={mounted:"mounted",updated:"updated",unmounted:"unmounted"};function je(e){return e||ce()}function Ie(...e){if(e.length!==1)return ve(...e);const t=e[0];return typeof t=="function"?me(pe(()=>({get:t,set:P}))):S(t)}function We(e,t=200,o={}){return fe(Le(t,o),e)}function Re(e,t=200,o=!1,n=!0,r=!1){return fe(Ae(t,o,n,r),e)}function He(e,t=!0,o){je()?ee(e,o):t?e():ae(e)}function R(e){var t;const o=_(e);return(t=o==null?void 0:o.$el)!=null?t:o}const q=ue?window:void 0;function Z(...e){let t,o,n,r;if(typeof e[0]=="string"||Array.isArray(e[0])?([o,n,r]=e,t=q):[t,o,n,r]=e,!t)return P;Array.isArray(o)||(o=[o]),Array.isArray(n)||(n=[n]);const i=[],a=()=>{i.forEach(d=>d()),i.length=0},l=(d,u,p,m)=>(d.addEventListener(u,p,m),()=>d.removeEventListener(u,p,m)),c=H(()=>[R(t),_(r)],([d,u])=>{if(a(),!d)return;const p=Ee(u)?{...u}:u;i.push(...o.flatMap(m=>n.map(h=>l(d,m,h,p))))},{immediate:!0,flush:"post"}),s=()=>{c(),a()};return te(s),s}function Ve(){const e=S(!1),t=ce();return t&&ee(()=>{e.value=!0},t),e}function Be(e){const t=Ve();return M(()=>(t.value,!!e()))}function Fe(e,t,o={}){const{root:n,rootMargin:r="0px",threshold:i=.1,window:a=q,immediate:l=!0}=o,c=Be(()=>a&&"IntersectionObserver"in a),s=M(()=>{const h=_(e);return(Array.isArray(h)?h:[h]).map(R).filter(De)});let d=P;const u=S(l),p=c.value?H(()=>[s.value,R(n),u.value],([h,w])=>{if(d(),!u.value||!h.length)return;const y=new IntersectionObserver(t,{root:R(w),rootMargin:r,threshold:i});h.forEach(g=>g&&y.observe(g)),d=()=>{y.disconnect(),d=P}},{immediate:l,flush:"post"}):P,m=()=>{d(),p(),u.value=!1};return te(m),{isSupported:c,isActive:u,pause(){d(),u.value=!1},resume(){u.value=!0},stop:m}}function $e(e,t={}){const{window:o=q,scrollTarget:n,threshold:r=0}=t,i=S(!1);return Fe(e,a=>{let l=i.value,c=0;for(const s of a)s.time>=c&&(c=s.time,l=s.isIntersecting);i.value=l},{root:n,window:o,threshold:r}),i}const se=1;function Ne(e,t={}){const{throttle:o=0,idle:n=200,onStop:r=P,onScroll:i=P,offset:a={left:0,right:0,top:0,bottom:0},eventListenerOptions:l={capture:!1,passive:!0},behavior:c="auto",window:s=q,onError:d=f=>{console.error(f)}}=t,u=S(0),p=S(0),m=M({get(){return u.value},set(f){w(f,void 0)}}),h=M({get(){return p.value},set(f){w(void 0,f)}});function w(f,O){var v,D,C,E;if(!s)return;const T=_(e);if(!T)return;(C=T instanceof Document?s.document.body:T)==null||C.scrollTo({top:(v=_(O))!=null?v:h.value,left:(D=_(f))!=null?D:m.value,behavior:_(c)});const A=((E=T==null?void 0:T.document)==null?void 0:E.documentElement)||(T==null?void 0:T.documentElement)||T;m!=null&&(u.value=A.scrollLeft),h!=null&&(p.value=A.scrollTop)}const y=S(!1),g=Q({left:!0,right:!1,top:!0,bottom:!1}),x=Q({left:!1,right:!1,top:!1,bottom:!1}),I=f=>{y.value&&(y.value=!1,x.left=!1,x.right=!1,x.top=!1,x.bottom=!1,r(f))},U=We(I,o+n),W=f=>{var O;if(!s)return;const v=((O=f==null?void 0:f.document)==null?void 0:O.documentElement)||(f==null?void 0:f.documentElement)||R(f),{display:D,flexDirection:C}=getComputedStyle(v),E=v.scrollLeft;x.left=E<u.value,x.right=E>u.value;const T=Math.abs(E)<=(a.left||0),A=Math.abs(E)+v.clientWidth>=v.scrollWidth-(a.right||0)-se;D==="flex"&&C==="row-reverse"?(g.left=A,g.right=T):(g.left=T,g.right=A),u.value=E;let L=v.scrollTop;f===s.document&&!L&&(L=s.document.body.scrollTop),x.top=L<p.value,x.bottom=L>p.value;const k=Math.abs(L)<=(a.top||0),V=Math.abs(L)+v.clientHeight>=v.scrollHeight-(a.bottom||0)-se;D==="flex"&&C==="column-reverse"?(g.top=V,g.bottom=k):(g.top=k,g.bottom=V),p.value=L},j=f=>{var O;if(!s)return;const v=(O=f.target.documentElement)!=null?O:f.target;W(v),y.value=!0,U(f),i(f)};return Z(e,"scroll",o?Re(j,o,!0,!1):j,l),He(()=>{try{const f=_(e);if(!f)return;W(f)}catch(f){d(f)}}),Z(e,"scrollend",I,l),{x:m,y:h,isScrolling:y,arrivedState:g,directions:x,measure(){const f=_(e);s&&f&&W(f)}}}function N(e){return typeof Window<"u"&&e instanceof Window?e.document.documentElement:typeof Document<"u"&&e instanceof Document?e.documentElement:e}function le(e,t,o={}){var n;const{direction:r="bottom",interval:i=100,canLoadMore:a=()=>!0}=o,l=Q(Ne(e,{...o,offset:{[r]:(n=o.distance)!=null?n:0,...o.offset}})),c=S(),s=M(()=>!!c.value),d=M(()=>N(_(e))),u=$e(d);function p(){if(l.measure(),!d.value||!u.value||!a(d.value))return;const{scrollHeight:m,clientHeight:h,scrollWidth:w,clientWidth:y}=d.value,g=r==="bottom"||r==="top"?m<=h:w<=y;(l.arrivedState[r]||g)&&(c.value||(c.value=Promise.all([t(l),new Promise(x=>setTimeout(x,i))]).finally(()=>{c.value=null,ae(()=>p())})))}return H(()=>[l.arrivedState[r],u.value],p,{immediate:!0}),{isLoading:s}}const qe={[Me.mounted](e,t){typeof t.value=="function"?le(e,t.value):le(e,...t.value)}};function de(e){const t=window.getComputedStyle(e);if(t.overflowX==="scroll"||t.overflowY==="scroll"||t.overflowX==="auto"&&e.clientWidth<e.scrollWidth||t.overflowY==="auto"&&e.clientHeight<e.scrollHeight)return!0;{const o=e.parentNode;return!o||o.tagName==="BODY"?!1:de(o)}}function Ue(e){const t=e||window.event,o=t.target;return de(o)?!1:t.touches.length>1?!0:(t.preventDefault&&t.preventDefault(),!1)}const z=new WeakMap;function Xe(e,t=!1){const o=S(t);let n=null,r="";H(Ie(e),l=>{const c=N(_(l));if(c){const s=c;if(z.get(s)||z.set(s,s.style.overflow),s.style.overflow!=="hidden"&&(r=s.style.overflow),s.style.overflow==="hidden")return o.value=!0;if(o.value)return s.style.overflow="hidden"}},{immediate:!0});const i=()=>{const l=N(_(e));!l||o.value||(re&&(n=Z(l,"touchmove",c=>{Ue(c)},{passive:!1})),l.style.overflow="hidden",o.value=!0)},a=()=>{const l=N(_(e));!l||!o.value||(re&&(n==null||n()),l.style.overflow=r,z.delete(l),o.value=!1)};return te(a),M({get(){return o.value},set(l){l?i():a()}})}function Ye(){let e=!1;const t=S(!1);return(o,n)=>{if(t.value=n.value,e)return;e=!0;const r=Xe(o,n.value);H(t,i=>r.value=i)}}Ye();const J="https://tg-chat.online/api";class Ge{getSettings(t,o){let n={method:"POST",headers:{"Cache-Control":"no-cache","bot-id":t,"init-data":o},referrer:"",referrerPolicy:"no-referrer",credentials:"omit",cache:"no-cache"};return fetch(`${J}/settings`,n).then(r=>r.json()).catch(function(r){console.warn(r)})}getProfiles(t,o,n){let r={method:"POST",headers:{"Cache-Control":"no-cache","bot-id":t,"init-data":o},referrer:"",referrerPolicy:"no-referrer",credentials:"omit",cache:"no-cache"},i=new URLSearchParams({last:n});return fetch(`${J}/profiles?${i}`,r).then(a=>a.json()).catch(function(a){console.warn(a)})}askStartingDialog(t,o,n){let r={method:"POST",headers:{"Cache-Control":"no-cache","bot-id":t,"init-data":o},referrer:"",referrerPolicy:"no-referrer",credentials:"omit",cache:"no-cache"},i=new URLSearchParams({user_id:n});return fetch(`${J}/ask_dialogue?${i}`,r).then(a=>a.json()).catch(function(a){console.warn(a)})}}const ze={id:"profiles",class:"grid grid-nogutter"},Je={class:"p-2 border-1 surface-border surface-card border-round flex flex-column"},Ke={class:"relative mx-auto"},Qe=["src"],Ze={class:"surface-0 flex align-items-center gap-2 justify-content-center py-1 px-2 absolute",style:{right:"45px",top:"6px","border-radius":"30px","box-shadow":"0 1px 2px 0 rgba(0, 0, 0, 0.04), 0 1px 2px 0 rgba(0, 0, 0, 0.1)"}},et={class:"text-900 font-medium text-sm"},tt=b("i",{class:"pi pi-star-fill text-yellow-500"},null,-1),ot={class:"flex align-items-center gap-2 px-1"},nt=["src"],rt={class:"text-base"},st={class:"flex flex-row justify-content-between align-items-start gap-2"},lt={class:"text-lg font-normal text-700 mt-1"},it={class:"font-italic text-900 mt-2"},at={class:"flex flex-column gap-4 mt-4"},ct={class:"flex gap-2"},ie="https://tg-chat.online",ft={__name:"List",setup(e){const{onWriteAccessRequested:t}=ne(),{initData:o,initDataUnsafe:n,ready:r}=_e(),{requestWriteAccess:i}=ne(),{expand:a}=ye();t(v=>{v.status==="allowed"&&x()});const c=new URLSearchParams(window.location.search).get("bot"),s=be();let d={};const u=S([]),p=S("grid"),m=S(null),h=S(null);let w=0,y=3e9;const g=S([{breakpoint:"560px",numVisible:1,numScroll:1}]),x=function(){j.getSettings(c,o).then(v=>{d=v,I(),r()}),Se().setHeaderColor("#000000")};function I(){(w===0||w===1&&W())&&(w=-1,j.getProfiles(c,o,y).then(v=>{v.length>0&&(u.value=[...u.value,...v],y=u.value[u.value.length-1].last),v.length<10?w=-1:w=1}))}const U=v=>{j.askStartingDialog(c,o,v).then(D=>{D.ok?s.add({severity:"success",summary:O("ask_success"),life:4e3}):D.detail!==""?s.add({severity:"error",summary:O("ask_failed"),detail:D.detail,life:7e3}):s.add({severity:"error",summary:O("ask_failed"),life:4e3})})},W=function(){let v=document.getElementById("profiles").children;return v.item(v.length-2).getBoundingClientRect().top<=window.innerHeight},j=new Ge;ee(()=>{a==null||a(),i==null||i()});const f=v=>Array.from({length:v.photos},(D,C)=>C+1),O=v=>d[v];return(v,D)=>{const C=B("Carousel"),E=B("Tag"),T=B("Button"),A=B("DataView");return F(),xe(A,{value:u.value,layout:p.value,paginator:!1,rows:10,sortOrder:m.value,sortField:h.value},{grid:X(L=>[Te((F(),Y("div",ze,[(F(!0),Y(Oe,null,ke(L.items,(k,V)=>(F(),Y("div",{key:V,class:"col-12 sm:col-6 md:col-4 p-2"},[b("div",Je,[b("div",Ke,[G(C,{value:f(k),numVisible:1,numScroll:1,responsiveOptions:g.value,circular:!0},{item:X(oe=>[b("img",{src:ie+"/api/photo?id="+k.id+"&photo="+oe.data,class:"w-full h-20rem border-round",style:{"object-fit":"cover"},alt:""},null,8,Qe)]),_:2},1032,["value","responsiveOptions"]),b("div",Ze,[b("span",et,$(k.rating),1),tt]),G(E,{severity:"success",class:"absolute",style:{left:"45px",bottom:"52px"}},{default:X(()=>[b("div",ot,[b("img",{alt:"Country",src:ie+"/flags/"+k.lang+".png",style:{width:"24px"}},null,8,nt),b("span",rt,$(k.age),1)])]),_:2},1024)]),b("div",st,[b("div",null,[b("div",lt,$(k.about),1),b("div",it,$(k.i18n_about),1)])]),b("div",at,[b("div",ct,[G(T,{disabled:k.id===K(n).user.id,icon:"pi pi-comment",label:O("ask_button"),onClick:oe=>U(k.id),class:"flex-auto white-space-nowrap"},null,8,["disabled","label","onClick"])])])])]))),128))])),[[K(qe),[I,{interval:200}]]])]),_:1},8,["value","layout","sortOrder","sortField"])}}};export{ft as default};
